<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ToMoreBeyond - Èù¢ÁôΩ„ÅÑ„Åì„Å®„Å†„Åë„Çí„Åô„Çã„ÄÇÂèã„Å®ÂÖ±„Å´ÈÅì„Å™„ÅçÈÅì„ÇíË∂ä„Åà„Çã</title>
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  
  <style>
    /* „É™„Çª„ÉÉ„ÉàCSS */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    /* Âü∫Êú¨„Çπ„Çø„Ç§„É´ */
    body {
      font-family: 'Share Tech Mono', monospace;
      overflow: hidden;
      position: relative;
      height: 100vh;
      background: #000;
    }
    
    /* ËÉåÊôØÂãïÁîª„Ç≥„É≥„ÉÜ„Éä - ÊúÄÈáçË¶Å */
    .video-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }
    
    /* ÂãïÁîªË¶ÅÁ¥† - „Éï„É´„Çπ„ÇØ„É™„Éº„É≥„Ç´„Éê„Éº */
    .video-container video {
      position: absolute;
      top: 50%;
      left: 50%;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      transform: translate(-50%, -50%);
      object-fit: cover;
    }
    
    /* ÂãïÁîª„Ç™„Éº„Éê„Éº„É¨„Ç§ÔºàÊöó„ÅïË™øÊï¥Ôºâ */
    .video-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      pointer-events: none;
    }
    
    /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„É©„ÉÉ„Éë„Éº */
    .content-wrapper {
      position: relative;
      z-index: 1;
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }
    
    /* „É≠„Ç¥ */
    .logo {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      font-family: 'Orbitron', monospace;
      font-size: 24px;
      font-weight: 700;
      color: #fff;
      text-decoration: none;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }
    
    /* „É°„Ç§„É≥„Ç≤„Éº„É†„Ç®„É™„Ç¢ */
    .game-area {
      position: relative;
      width: 100%;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* „Ç´„Éº„Éâ„Ç≥„É≥„ÉÜ„Éä */
    .cards-container {
      position: relative;
      width: 100%;
      height: 400px;
      overflow: hidden;
      padding: 0 50px;
    }
    
    .cards-track {
      display: flex;
      gap: 24px;
      transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      padding: 0 50px;
    }
    
    /* „Ç´„Éº„Éâ„Çπ„Çø„Ç§„É´ */
    .card {
      min-width: 280px;
      height: 360px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 4px solid #000;
      border-radius: 16px;
      padding: 32px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    
    .card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    }
    
    .card-icon {
      font-size: 48px;
      margin-bottom: 20px;
      color: #000;
    }
    
    .card-title {
      font-family: 'Orbitron', monospace;
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 12px;
      color: #000;
    }
    
    .card-description {
      font-size: 14px;
      color: #666;
      line-height: 1.5;
    }
    
    /* 8bit„É¨„Éà„É≠„Ç≤„Éº„É†È¢®„Ç≠„É£„É©„ÇØ„Çø„Éº */
    .character-container {
      position: fixed;
      bottom: 100px;
      left: 50px;
      z-index: 100;
      transition: left 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    
    .character {
      width: 80px;
      height: 80px;
      position: relative;
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }
    
    /* 8bit„Éî„ÇØ„Çª„É´„Ç¢„Éº„Éà„Ç∑„Çπ„ÉÜ„É† */
    .pixel-character {
      position: relative;
      width: 100%;
      height: 100%;
    }
    
    .pixel-grid {
      position: relative;
      width: 20px;
      height: 42px;
      transform: scale(3);
      transform-origin: top left;
      image-rendering: pixelated;
    }
    
    .pixel {
      position: absolute;
      background: #00ff00;
      image-rendering: pixelated;
      box-shadow: 1px 1px 0 rgba(0, 255, 0, 0.3);
    }
    
    /* „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆÁä∂ÊÖãÂ§âÊõ¥ */
    .character.walking .pixel {
      animation: pixelWalk 0.6s infinite;
    }
    
    @keyframes pixelWalk {
      0%, 100% { background: #00ff00; }
      50% { background: #00cc00; }
    }
    
    /* „Ç∏„É£„É≥„Éó„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
    .character.jumping {
      animation: pixelJump 0.6s ease;
    }
    
    @keyframes pixelJump {
      0% { transform: translateY(0) scaleY(1); }
      20% { transform: translateY(-5px) scaleY(0.9); }
      50% { transform: translateY(-30px) scaleY(1.1); }
      80% { transform: translateY(-5px) scaleY(0.9); }
      100% { transform: translateY(0) scaleY(1); }
    }
    
    /* „É¨„Éô„É´„Ç¢„ÉÉ„ÉóÊôÇ„ÅÆËâ≤Â§âÂåñ */
    .character.level-up .pixel {
      background: #ff0000 !important;
      box-shadow: 1px 1px 0 rgba(255, 0, 0, 0.5), 0 0 8px #ff0000;
      animation: levelUpGlow 2s ease-in-out infinite;
    }
    
    @keyframes levelUpGlow {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(2); }
    }
    
    /* „É¨„Éô„É´Ë°®Á§∫ */
    .level-display {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      padding: 16px 24px;
      border-radius: 8px;
      color: #fff;
      font-family: 'Orbitron', monospace;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }
    
    .level-text {
      font-size: 14px;
      margin-bottom: 8px;
    }
    
    .exp-bar {
      width: 200px;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
    }
    
    .exp-fill {
      height: 100%;
      background: linear-gradient(90deg, #00ff00, #00cc00);
      transition: width 0.3s ease;
      width: 0%;
    }
    
    /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
    @media (max-width: 768px) {
      .logo {
        font-size: 18px;
      }
      
      .card {
        min-width: 240px;
        height: 320px;
        padding: 24px;
      }
      
      .card-icon {
        font-size: 40px;
      }
      
      .card-title {
        font-size: 18px;
      }
      
      .character-container {
        bottom: 60px;
        left: 30px;
      }
      
      .character {
        width: 50px;
        height: 70px;
      }
    }
    
    /* „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    
    /* ‰Ωé„Çπ„Éö„ÉÉ„ÇØ„Éá„Éê„Ç§„ÇπÂêë„ÅëÊúÄÈÅ©Âåñ */
    .low-performance-mode .video-container video {
      display: none;
    }
    
    .low-performance-mode .video-overlay {
      background: linear-gradient(135deg, #1a1a1a 0%, #000 100%);
    }
    
    .low-performance-mode .card {
      backdrop-filter: none;
      -webkit-backdrop-filter: none;
      background: rgba(255, 255, 255, 0.98);
      transition: transform 0.2s ease !important;
    }
    
    .low-performance-mode .character-container {
      transition: left 0.3s linear !important;
    }
    
    /* GPU„Ç¢„ÇØ„Çª„É©„É¨„Éº„Ç∑„Éß„É≥ÊúÄÈÅ©Âåñ */
    .cards-track {
      will-change: transform;
      transform: translateZ(0);
    }
    
    .character-container {
      will-change: left;
      transform: translateZ(0);
    }
    
    .card {
      will-change: transform;
      transform: translateZ(0);
    }
    
    /* „É≠„Éº„Éá„Ç£„É≥„Ç∞Ë°®Á§∫Ôºà„Ç∑„É≥„Éó„É´Ôºâ */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }
    
    .loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .loading-text {
      color: #fff;
      font-size: 18px;
      font-family: 'Orbitron', monospace;
    }
  </style>
</head>
<body>
  <!-- ËÉåÊôØÂãïÁîª -->
  <div class="video-container">
    <video id="bgVideo" muted loop playsinline preload="metadata" style="width: 100%; height: 100%; object-fit: cover;">
      <source src="backvideo.mp4" type="video/mp4">
    </video>
    <div class="video-overlay"></div>
  </div>
  
  <!-- ÂãïÁîªÁä∂ÊÖãÁ¢∫Ë™çÁî® -->
  <div id="videoDebug" style="position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: #00ff00; padding: 8px; font-size: 12px; z-index: 9999; font-family: monospace;">
    üé• Video: Loading...
  </div>
  
  <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
  <div class="content-wrapper">
    <!-- „É≠„Ç¥ -->
    <a href="/" class="logo">ToMoreBeyond</a>
    
    <!-- „É¨„Éô„É´Ë°®Á§∫ -->
    <div class="level-display">
      <div class="level-text">Level <span id="currentLevel">1</span></div>
      <div class="exp-bar">
        <div class="exp-fill" id="expFill"></div>
      </div>
    </div>
    
    <!-- „Ç≤„Éº„É†„Ç®„É™„Ç¢ -->
    <div class="game-area">
      <div class="cards-container">
        <div class="cards-track" id="cardsTrack">
          <!-- „Ç´„Éº„Éâ„ÅØÂãïÁöÑ„Å´ÁîüÊàê -->
        </div>
      </div>
    </div>
    
    <!-- 8bit„É¨„Éà„É≠„Ç≤„Éº„É†È¢®„Ç≠„É£„É©„ÇØ„Çø„Éº -->
    <div class="character-container" id="character">
      <div class="character">
        <div class="pixel-character">
          <div class="pixel-grid">
            <!-- 8bit„Éî„ÇØ„Çª„É´„Ç¢„Éº„Éà„ÅÆÊ£í‰∫∫Èñì -->
            <!-- È†≠ÈÉ® -->
            <div class="pixel" style="left: 6px; top: 2px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 10px; top: 2px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 14px; top: 2px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 4px; top: 6px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 8px; top: 6px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 12px; top: 6px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 16px; top: 6px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 4px; top: 10px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 16px; top: 10px; width: 4px; height: 4px;"></div>
            
            <!-- ‰ΩìÈÉ® -->
            <div class="pixel" style="left: 10px; top: 14px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 10px; top: 18px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 10px; top: 22px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 10px; top: 26px; width: 4px; height: 4px;"></div>
            
            <!-- ËÖï -->
            <div class="pixel" style="left: 6px; top: 18px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 14px; top: 18px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 2px; top: 22px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 18px; top: 22px; width: 4px; height: 4px;"></div>
            
            <!-- Ë∂≥ -->
            <div class="pixel" style="left: 8px; top: 30px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 12px; top: 30px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 6px; top: 34px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 14px; top: 34px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 4px; top: 38px; width: 4px; height: 4px;"></div>
            <div class="pixel" style="left: 16px; top: 38px; width: 4px; height: 4px;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- „É≠„Éº„Éá„Ç£„É≥„Ç∞ -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-text">Loading...</div>
  </div>
  
  <script>
    // „Ç≤„Éº„É†„ÇØ„É©„Çπ
    class VideoBackgroundGame {
      constructor() {
        this.cards = [
          { icon: '[]', title: '‰ºöÁ§æÊ¶ÇË¶Å', description: 'MICHI NAKI MICHI WO KIRU' },
          { icon: 'X', title: '„Éü„ÉÉ„Ç∑„Éß„É≥', description: 'OMOSHIROI KOTO DAKE WO SURU' },
          { icon: '+', title: 'TADATAKA', description: 'IDOU GA SONO MAMA NIKKI NI' },
          { icon: 'T', title: 'TOIRUN', description: 'IMA SUGU TOIRE WO SAITAN DE' },
          { icon: 'M', title: 'MEET IN THE MIDDLE', description: 'SAITEKI NA SHUUGOU CHITEN WO' },
          { icon: 'Y', title: 'Â±±Áî∞', description: 'CDO / DESIGNER' },
          { icon: 'M', title: 'Ê≠£Áïô', description: 'CEO / ENGINEER' },
          { icon: 'A', title: 'ÂÆâËó§', description: 'ARTIST' },
          { icon: 'B', title: '„Éñ„É≠„Ç∞', description: 'KAIHATSU NO URA BANASHI' },
          { icon: 'V', title: 'ÂãïÁîª', description: 'PRODUCT SHOUKAI' },
          { icon: 'S', title: 'SNS', description: 'HIBI NO HASSHIN' },
          { icon: '@', title: '„ÅäÂïè„ÅÑÂêà„Çè„Åõ', description: 'OKI GARU NI DOUZO' }
        ];
        
        this.currentLevel = 1;
        this.currentExp = 0;
        this.maxExp = 100;
        this.characterPosition = 0;
        this.viewedCards = new Set();
        
        // „É°„É¢„É™ÊúÄÈÅ©Âåñ„ÅÆ„Åü„ÇÅ„ÅÆË®≠ÂÆö
        this.isLowEndDevice = this.detectLowEndDevice();
        this.lastUpdateTime = 0;
        this.rafId = null;
        this.eventListeners = [];
        
        this.init();
      }
      
      detectLowEndDevice() {
        // „É°„É¢„É™Âà∂Èôê„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
        if ('deviceMemory' in navigator && navigator.deviceMemory < 2) {
          return true;
        }
        
        // CPU„Ç≥„Ç¢Êï∞„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
        if ('hardwareConcurrency' in navigator && navigator.hardwareConcurrency <= 2) {
          return true;
        }
        
        // „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÈÄüÂ∫¶„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
        if ('connection' in navigator) {
          const connection = navigator.connection;
          if (connection.saveData || connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g') {
            return true;
          }
        }
        
        return false;
      }
      
      init() {
        // ‰Ωé„Çπ„Éö„ÉÉ„ÇØ„Éá„Éê„Ç§„Çπ„ÅÆÂ†¥Âêà„ÅØ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„É¢„Éº„Éâ„ÇíÈÅ©Áî®
        if (this.isLowEndDevice) {
          document.body.classList.add('low-performance-mode');
        }
        
        // „Ç´„Éº„Éâ„ÇíÁîüÊàê
        this.createCards();
        
        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
        this.setupEventListeners();
        
        // ÂãïÁîª„ÅÆËá™ÂãïÂÜçÁîüÔºà‰Ωé„Çπ„Éö„ÉÉ„ÇØ„Éá„Éê„Ç§„Çπ„Åß„ÅØ„Çπ„Ç≠„ÉÉ„ÉóÔºâ
        if (!this.isLowEndDevice) {
          this.setupVideo();
        }
        
        // „É°„É¢„É™Áõ£Ë¶ñ„ÅÆ„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
        this.setupMemoryMonitoring();
        
        // „É≠„Éº„Éá„Ç£„É≥„Ç∞ÂÆå‰∫Ü
        this.hideLoading();
      }
      
      setupMemoryMonitoring() {
        // „É°„É¢„É™Áõ£Ë¶ñÔºà‰Ωé„Çπ„Éö„ÉÉ„ÇØ„Éá„Éê„Ç§„Çπ„ÅÆ„ÅøÔºâ
        if (this.isLowEndDevice && 'performance' in window && 'memory' in performance) {
          setInterval(() => {
            const memoryInfo = performance.memory;
            const memoryUsageRatio = memoryInfo.usedJSHeapSize / memoryInfo.jsHeapSizeLimit;
            
            if (memoryUsageRatio > 0.8) {
              this.emergencyCleanup();
            }
          }, 30000); // 30Áßí„Åî„Å®„Å´„ÉÅ„Çß„ÉÉ„ÇØ
        }
      }
      
      emergencyCleanup() {
        // Á∑äÊÄ•„É°„É¢„É™„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
        console.warn('‚ö†Ô∏è „É°„É¢„É™„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÂÆüË°å');
        
        // ‰∏çË¶Å„Å™„Éá„Éº„Çø„Çí„ÇØ„É™„Ç¢
        this.viewedCards.clear();
        
        // ÂãïÁîª„Çí‰∏ÄÊôÇÂÅúÊ≠¢
        const video = document.getElementById('bgVideo');
        if (video) {
          video.pause();
        }
        
        // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíÂÅúÊ≠¢
        if (this.rafId) {
          cancelAnimationFrame(this.rafId);
          this.rafId = null;
        }
      }
      
      createCards() {
        const track = document.getElementById('cardsTrack');
        
        this.cards.forEach((card, index) => {
          const cardEl = document.createElement('div');
          cardEl.className = 'card';
          cardEl.dataset.index = index;
          cardEl.innerHTML = `
            <div class="card-icon">${card.icon}</div>
            <h3 class="card-title">${card.title}</h3>
            <p class="card-description">${card.description}</p>
          `;
          
          cardEl.addEventListener('click', () => this.onCardClick(index));
          track.appendChild(cardEl);
        });
      }
      
      setupEventListeners() {
        // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ„Åï„Çå„Åü„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        const wheelHandler = this.throttle((e) => {
          e.preventDefault();
          this.handleScroll(e.deltaY);
        }, 16); // 60fps
        
        const keyHandler = (e) => {
          if (e.key === 'ArrowRight') {
            this.moveCharacter(0.05);
          } else if (e.key === 'ArrowLeft') {
            this.moveCharacter(-0.05);
          } else if (e.key === ' ') {
            e.preventDefault();
            this.jump();
          }
        };
        
        // „Çø„ÉÉ„ÉÅÊìç‰ΩúÔºà„É¢„Éê„Ç§„É´Ôºâ
        let touchStartX = 0;
        const touchStartHandler = (e) => {
          touchStartX = e.touches[0].clientX;
        };
        
        const touchMoveHandler = this.throttle((e) => {
          e.preventDefault();
          const touchX = e.touches[0].clientX;
          const diff = (touchStartX - touchX) * 0.001;
          this.handleScroll(diff * 100);
          touchStartX = touchX;
        }, 16);
        
        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíÁôªÈå≤
        document.addEventListener('wheel', wheelHandler, { passive: false });
        document.addEventListener('keydown', keyHandler);
        document.addEventListener('touchstart', touchStartHandler, { passive: true });
        document.addEventListener('touchmove', touchMoveHandler, { passive: false });
        
        // „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÁî®„Å´‰øùÂ≠ò
        this.eventListeners.push(
          { element: document, type: 'wheel', handler: wheelHandler },
          { element: document, type: 'keydown', handler: keyHandler },
          { element: document, type: 'touchstart', handler: touchStartHandler },
          { element: document, type: 'touchmove', handler: touchMoveHandler }
        );
      }
      
      throttle(func, limit) {
        let inThrottle;
        return function() {
          const args = arguments;
          const context = this;
          if (!inThrottle) {
            func.apply(context, args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
          }
        };
      }
      
      setupVideo() {
        const video = document.getElementById('bgVideo');
        const debug = document.getElementById('videoDebug');
        
        if (!video) {
          console.error('ÂãïÁîªË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
          return;
        }
        
        // ÂãïÁîª„ÅÆÁä∂ÊÖã„Çí„Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫
        const updateDebug = (status) => {
          if (debug) debug.textContent = `üé• Video: ${status}`;
          console.log('üé• Video status:', status);
        };
        
        updateDebug('Initializing...');
        
        // ÂãïÁîª„ÅÆÂü∫Êú¨Ë®≠ÂÆö
        video.muted = true;
        video.loop = true;
        video.playsInline = true;
        video.preload = 'auto';
        
        // ÂÜçÁîüÈñ¢Êï∞
        const playVideo = () => {
          const playPromise = video.play();
          if (playPromise !== undefined) {
            playPromise.then(() => {
              updateDebug('Playing ‚úì');
            }).catch(error => {
              updateDebug('Failed: ' + error.message);
              console.error('ÂãïÁîªÂÜçÁîü„Ç®„É©„Éº:', error);
            });
          }
        };
        
        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        video.addEventListener('loadstart', () => updateDebug('Loading started'));
        video.addEventListener('loadedmetadata', () => updateDebug('Metadata loaded'));
        video.addEventListener('loadeddata', () => updateDebug('Data loaded'));
        video.addEventListener('canplay', () => {
          updateDebug('Can play');
          playVideo();
        });
        video.addEventListener('canplaythrough', () => updateDebug('Can play through'));
        video.addEventListener('playing', () => updateDebug('Playing ‚úì'));
        video.addEventListener('error', (e) => {
          updateDebug('Error: ' + e.message);
          console.error('ÂãïÁîª„Ç®„É©„Éº:', e);
        });
        
        // Âç≥Â∫ß„Å´Ë™≠„ÅøËæº„ÅøÈñãÂßã
        video.load();
        
        // „É¶„Éº„Ç∂„Éº„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥Âæå„Å´ÂÜçÁîü„ÇíË©¶Ë°å
        const interactionEvents = ['click', 'touchstart', 'keydown'];
        const enableAutoplay = () => {
          playVideo();
          // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíÂâäÈô§
          interactionEvents.forEach(event => {
            document.removeEventListener(event, enableAutoplay);
          });
        };
        
        interactionEvents.forEach(event => {
          document.addEventListener(event, enableAutoplay, { once: true, passive: true });
        });
        
        // „Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†±„ÇíÈùûË°®Á§∫Ôºà5ÁßíÂæåÔºâ
        setTimeout(() => {
          if (debug) debug.style.display = 'none';
        }, 5000);
      }
      
      hideLoading() {
        setTimeout(() => {
          const loadingOverlay = document.getElementById('loadingOverlay');
          loadingOverlay.classList.add('hidden');
          
          setTimeout(() => {
            loadingOverlay.style.display = 'none';
          }, 500);
        }, 1000);
      }
      
      handleScroll(deltaY) {
        // „Çπ„ÇØ„É≠„Éº„É´Èáè„Çí‰ΩçÁΩÆ„Å´Â§âÊèõÔºà„Çà„ÇäÁ∑ªÁ¥∞„Å™Âà∂Âæ°Ôºâ
        const sensitivity = 0.002; // „Çπ„ÇØ„É≠„Éº„É´ÊÑüÂ∫¶„Çí‰∏ä„Åí„Çã
        const scrollAmount = deltaY * sensitivity;
        this.moveCharacter(scrollAmount);
        
        // Ê≠©Ë°å„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíÈñãÂßã
        this.startWalkingAnimation();
        
        // Ê≠©Ë°åÂÅúÊ≠¢„Çø„Ç§„Éû„Éº
        clearTimeout(this.walkingTimeout);
        this.walkingTimeout = setTimeout(() => {
          this.stopWalkingAnimation();
        }, 300);
      }
      
      startWalkingAnimation() {
        const character = document.querySelector('.character');
        if (character) {
          character.classList.add('walking');
        }
      }
      
      stopWalkingAnimation() {
        const character = document.querySelector('.character');
        if (character) {
          character.classList.remove('walking');
        }
      }
      
      moveCharacter(amount) {
        // „Ç≠„É£„É©„ÇØ„Çø„Éº‰ΩçÁΩÆ„ÇíÊõ¥Êñ∞Ôºà0„Äú1„ÅÆÁØÑÂõ≤Ôºâ
        this.characterPosition = Math.max(0, Math.min(1, this.characterPosition + amount));
        
        // „Ç≠„É£„É©„ÇØ„Çø„Éº„Å®„Ç´„Éº„Éâ„ÇíÁßªÂãï
        this.updatePositions();
      }
      
      updatePositions() {
        // RAF„Åß„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ
        if (this.rafId) {
          cancelAnimationFrame(this.rafId);
        }
        
        this.rafId = requestAnimationFrame(() => {
          const character = document.getElementById('character');
          const track = document.getElementById('cardsTrack');
          const screenWidth = window.innerWidth;
          
          // „Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆ‰ΩçÁΩÆ„ÇíË®àÁÆó
          let charX;
          if (this.characterPosition <= 0.05) {
            // ÈñãÂßã‰ΩçÁΩÆÔºà„Çà„ÇäÁ≤æÁ∑ª„Å™Âà∂Âæ°Ôºâ
            charX = 50 + (screenWidth * 0.25 - 50) * (this.characterPosition / 0.05);
          } else if (this.characterPosition >= 0.95) {
            // ÁµÇ‰∫Ü‰ΩçÁΩÆÔºàÊúÄÂæå„ÅÆ„Ç´„Éº„Éâ„Å®ÂÆåÂÖ®ÂêåÊúüÔºâ
            charX = screenWidth * 0.25 + (screenWidth - 100 - screenWidth * 0.25) * ((this.characterPosition - 0.95) / 0.05);
          } else {
            // ‰∏≠Èñì„ÅØ„Ç≠„É£„É©„ÇØ„Çø„Éº„ÇíÂõ∫ÂÆö
            charX = screenWidth * 0.25;
          }
          
          character.style.left = charX + 'px';
          
          // „Ç´„Éº„Éâ„ÅÆ„Çπ„ÇØ„É≠„Éº„É´ÔºàÊúÄÂæå„ÅÆ„Ç´„Éº„Éâ„ÅåÂè≥Á´Ø„Å´Êù•„Çã„Çà„ÅÜ„Å´Ë™øÊï¥Ôºâ
          const cardWidth = 304; // „Ç´„Éº„ÉâÂπÖ + gap
          const totalWidth = cardWidth * this.cards.length;
          const maxScroll = totalWidth - charX - 280; // „Ç´„Éº„ÉâÂπÖ„ÇíËÄÉÊÖÆ
          const scrollX = -Math.max(0, Math.min(maxScroll, maxScroll * this.characterPosition));
          
          track.style.transform = `translateX(${scrollX}px) translateZ(0)`;
          
          // ÁèæÂú®„ÅÆ„Ç´„Éº„Éâ„Çí„Éè„Ç§„É©„Ç§„Éà
          const currentCardIndex = Math.round(this.characterPosition * (this.cards.length - 1));
          this.highlightCard(currentCardIndex);
        });
      }
      
      highlightCard(index) {
        const cards = document.querySelectorAll('.card');
        cards.forEach((card, i) => {
          if (i === index) {
            card.style.transform = 'translateY(-5px) scale(1.02)';
            card.style.boxShadow = '0 20px 40px rgba(0,0,0,0.4)';
          } else {
            card.style.transform = '';
            card.style.boxShadow = '';
          }
        });
      }
      
      onCardClick(index) {
        if (!this.viewedCards.has(index)) {
          this.viewedCards.add(index);
          this.gainExp(10);
        }
      }
      
      gainExp(amount) {
        this.currentExp += amount;
        
        if (this.currentExp >= this.maxExp) {
          this.levelUp();
        }
        
        this.updateUI();
      }
      
      levelUp() {
        this.currentLevel++;
        this.currentExp = 0;
        
        // 8bit„É¨„Éô„É´„Ç¢„ÉÉ„Éó„Ç®„Éï„Çß„ÇØ„Éà
        const character = document.querySelector('.character');
        if (character) {
          character.classList.add('level-up');
          setTimeout(() => {
            character.classList.remove('level-up');
          }, 2000);
        }
        
        // ÊúÄÂ§ß„É¨„Éô„É´ÊôÇ„ÅØËµ§Ëâ≤„Å´Â§âÊõ¥
        if (this.currentLevel >= this.cards.length) {
          setTimeout(() => {
            const pixels = document.querySelectorAll('.pixel');
            pixels.forEach(pixel => {
              pixel.style.background = '#ff0000';
              pixel.style.boxShadow = '1px 1px 0 rgba(255, 0, 0, 0.5), 0 0 8px #ff0000';
            });
          }, 2000);
        }
      }
      
      updateUI() {
        const levelEl = document.getElementById('currentLevel');
        const expFill = document.getElementById('expFill');
        
        levelEl.textContent = this.currentLevel;
        expFill.style.width = (this.currentExp / this.maxExp * 100) + '%';
      }
      
      jump() {
        const character = document.querySelector('.character');
        if (character && !character.classList.contains('jumping')) {
          character.classList.add('jumping');
          
          setTimeout(() => {
            character.classList.remove('jumping');
          }, 600);
        }
      }
      
      cleanup() {
        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„Çí„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
        this.eventListeners.forEach(({ element, type, handler }) => {
          element.removeEventListener(type, handler);
        });
        this.eventListeners = [];
        
        // RAF„Çí„Ç≠„É£„É≥„Çª„É´
        if (this.rafId) {
          cancelAnimationFrame(this.rafId);
          this.rafId = null;
        }
        
        // ÂãïÁîª„ÇíÂÅúÊ≠¢
        const video = document.getElementById('bgVideo');
        if (video) {
          video.pause();
          video.src = '';
        }
        
        // „Éá„Éº„Çø„Çí„ÇØ„É™„Ç¢
        this.viewedCards.clear();
        this.cards = null;
        
        console.log('üßπ „Ç≤„Éº„É†„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÂÆå‰∫Ü');
      }
    }
    
    // „Ç≤„Éº„É†ÈñãÂßã
    document.addEventListener('DOMContentLoaded', () => {
      window.gameInstance = new VideoBackgroundGame();
    });
    
    // „Éö„Éº„Ç∏Èõ¢ËÑ±ÊôÇ„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
    window.addEventListener('beforeunload', () => {
      if (window.gameInstance) {
        window.gameInstance.cleanup();
      }
    });
    
    // „Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„Åß„ÅÆ„É°„É¢„É™ÊúÄÈÅ©Âåñ
    document.addEventListener('visibilitychange', () => {
      if (window.gameInstance) {
        const video = document.getElementById('bgVideo');
        if (document.hidden) {
          // „Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„ÅßÂãïÁîª„Çí‰∏ÄÊôÇÂÅúÊ≠¢
          if (video) video.pause();
        } else {
          // „Éï„Ç©„Ç¢„Ç∞„É©„Ç¶„É≥„Éâ„ÅßÂãïÁîª„ÇíÂÜçÈñã
          if (video && !window.gameInstance.isLowEndDevice) {
            video.play().catch(() => {});
          }
        }
      }
    });
  </script>
</body>
</html>