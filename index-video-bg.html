<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ToMoreBeyond - 面白いことだけをする。友と共に道なき道を越える</title>
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  
  <style>
    /* リセットCSS */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    /* 基本スタイル */
    body {
      font-family: 'Share Tech Mono', monospace;
      overflow: hidden;
      position: relative;
      height: 100vh;
      background: #000;
    }
    
    /* 背景動画コンテナ - 最重要 */
    .video-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }
    
    /* 動画要素 - フルスクリーンカバー */
    .video-container video {
      position: absolute;
      top: 50%;
      left: 50%;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      transform: translate(-50%, -50%);
      object-fit: cover;
    }
    
    /* 動画オーバーレイ（暗さ調整） */
    .video-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      pointer-events: none;
    }
    
    /* メインコンテンツラッパー */
    .content-wrapper {
      position: relative;
      z-index: 1;
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }
    
    /* ロゴ */
    .logo {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      font-family: 'Orbitron', monospace;
      font-size: 24px;
      font-weight: 700;
      color: #fff;
      text-decoration: none;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }
    
    /* メインゲームエリア */
    .game-area {
      position: relative;
      width: 100%;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* カードコンテナ */
    .cards-container {
      position: relative;
      width: 100%;
      height: 400px;
      overflow: hidden;
      padding: 0 50px;
    }
    
    .cards-track {
      display: flex;
      gap: 24px;
      transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      padding: 0 50px;
    }
    
    /* カードスタイル */
    .card {
      min-width: 280px;
      height: 360px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 4px solid #000;
      border-radius: 16px;
      padding: 32px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    
    .card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    }
    
    .card-icon {
      font-size: 48px;
      margin-bottom: 20px;
      color: #000;
    }
    
    .card-title {
      font-family: 'Orbitron', monospace;
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 12px;
      color: #000;
    }
    
    .card-description {
      font-size: 14px;
      color: #666;
      line-height: 1.5;
    }
    
    /* キャラクター（棒人間） */
    .character-container {
      position: fixed;
      bottom: 80px;
      left: 50px;
      z-index: 100;
      transition: left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    
    .character {
      width: 60px;
      height: 80px;
      position: relative;
    }
    
    /* 棒人間のSVG描画 */
    .character-body {
      width: 100%;
      height: 100%;
    }
    
    /* レベル表示 */
    .level-display {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      padding: 16px 24px;
      border-radius: 8px;
      color: #fff;
      font-family: 'Orbitron', monospace;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }
    
    .level-text {
      font-size: 14px;
      margin-bottom: 8px;
    }
    
    .exp-bar {
      width: 200px;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
    }
    
    .exp-fill {
      height: 100%;
      background: linear-gradient(90deg, #00ff00, #00cc00);
      transition: width 0.3s ease;
      width: 0%;
    }
    
    /* レスポンシブ対応 */
    @media (max-width: 768px) {
      .logo {
        font-size: 18px;
      }
      
      .card {
        min-width: 240px;
        height: 320px;
        padding: 24px;
      }
      
      .card-icon {
        font-size: 40px;
      }
      
      .card-title {
        font-size: 18px;
      }
      
      .character-container {
        bottom: 60px;
        left: 30px;
      }
      
      .character {
        width: 50px;
        height: 70px;
      }
    }
    
    /* パフォーマンス最適化 */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    
    /* ローディング表示（シンプル） */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }
    
    .loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .loading-text {
      color: #fff;
      font-size: 18px;
      font-family: 'Orbitron', monospace;
    }
  </style>
</head>
<body>
  <!-- 背景動画 -->
  <div class="video-container">
    <video id="bgVideo" autoplay muted loop playsinline preload="auto">
      <source src="backvideo.mp4" type="video/mp4">
      <!-- WebM形式も追加（ブラウザ互換性） -->
      <source src="backvideo.webm" type="video/webm">
    </video>
    <div class="video-overlay"></div>
  </div>
  
  <!-- メインコンテンツ -->
  <div class="content-wrapper">
    <!-- ロゴ -->
    <a href="/" class="logo">ToMoreBeyond</a>
    
    <!-- レベル表示 -->
    <div class="level-display">
      <div class="level-text">Level <span id="currentLevel">1</span></div>
      <div class="exp-bar">
        <div class="exp-fill" id="expFill"></div>
      </div>
    </div>
    
    <!-- ゲームエリア -->
    <div class="game-area">
      <div class="cards-container">
        <div class="cards-track" id="cardsTrack">
          <!-- カードは動的に生成 -->
        </div>
      </div>
    </div>
    
    <!-- キャラクター（棒人間） -->
    <div class="character-container" id="character">
      <div class="character">
        <svg class="character-body" viewBox="0 0 60 80">
          <!-- 頭 -->
          <circle cx="30" cy="15" r="10" fill="#fff" stroke="#000" stroke-width="2"/>
          <!-- 体 -->
          <line x1="30" y1="25" x2="30" y2="50" stroke="#fff" stroke-width="3"/>
          <!-- 左腕 -->
          <line x1="30" y1="35" x2="20" y2="45" stroke="#fff" stroke-width="2"/>
          <!-- 右腕 -->
          <line x1="30" y1="35" x2="40" y2="45" stroke="#fff" stroke-width="2"/>
          <!-- 左足 -->
          <line x1="30" y1="50" x2="20" y2="70" stroke="#fff" stroke-width="2"/>
          <!-- 右足 -->
          <line x1="30" y1="50" x2="40" y2="70" stroke="#fff" stroke-width="2"/>
        </svg>
      </div>
    </div>
  </div>
  
  <!-- ローディング -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-text">Loading...</div>
  </div>
  
  <script>
    // ゲームクラス
    class VideoBackgroundGame {
      constructor() {
        this.cards = [
          { icon: '[]', title: '会社概要', description: 'MICHI NAKI MICHI WO KIRU' },
          { icon: 'X', title: 'ミッション', description: 'OMOSHIROI KOTO DAKE WO SURU' },
          { icon: '+', title: 'TADATAKA', description: 'IDOU GA SONO MAMA NIKKI NI' },
          { icon: 'T', title: 'TOIRUN', description: 'IMA SUGU TOIRE WO SAITAN DE' },
          { icon: 'M', title: 'MEET IN THE MIDDLE', description: 'SAITEKI NA SHUUGOU CHITEN WO' },
          { icon: 'Y', title: '山田', description: 'CDO / DESIGNER' },
          { icon: 'M', title: '正留', description: 'CEO / ENGINEER' },
          { icon: 'A', title: '安藤', description: 'ARTIST' },
          { icon: 'B', title: 'ブログ', description: 'KAIHATSU NO URA BANASHI' },
          { icon: 'V', title: '動画', description: 'PRODUCT SHOUKAI' },
          { icon: 'S', title: 'SNS', description: 'HIBI NO HASSHIN' },
          { icon: '@', title: 'お問い合わせ', description: 'OKI GARU NI DOUZO' }
        ];
        
        this.currentLevel = 1;
        this.currentExp = 0;
        this.maxExp = 100;
        this.characterPosition = 0;
        this.viewedCards = new Set();
        
        this.init();
      }
      
      init() {
        // カードを生成
        this.createCards();
        
        // イベントリスナー設定
        this.setupEventListeners();
        
        // 動画の自動再生
        this.setupVideo();
        
        // ローディング完了
        this.hideLoading();
      }
      
      createCards() {
        const track = document.getElementById('cardsTrack');
        
        this.cards.forEach((card, index) => {
          const cardEl = document.createElement('div');
          cardEl.className = 'card';
          cardEl.dataset.index = index;
          cardEl.innerHTML = `
            <div class="card-icon">${card.icon}</div>
            <h3 class="card-title">${card.title}</h3>
            <p class="card-description">${card.description}</p>
          `;
          
          cardEl.addEventListener('click', () => this.onCardClick(index));
          track.appendChild(cardEl);
        });
      }
      
      setupEventListeners() {
        // マウスホイールでスクロール
        document.addEventListener('wheel', (e) => {
          e.preventDefault();
          this.handleScroll(e.deltaY);
        });
        
        // キーボード操作
        document.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowRight') {
            this.moveCharacter(0.05);
          } else if (e.key === 'ArrowLeft') {
            this.moveCharacter(-0.05);
          } else if (e.key === ' ') {
            e.preventDefault();
            this.jump();
          }
        });
        
        // タッチ操作（モバイル）
        let touchStartX = 0;
        document.addEventListener('touchstart', (e) => {
          touchStartX = e.touches[0].clientX;
        });
        
        document.addEventListener('touchmove', (e) => {
          e.preventDefault();
          const touchX = e.touches[0].clientX;
          const diff = (touchStartX - touchX) * 0.001;
          this.handleScroll(diff * 100);
          touchStartX = touchX;
        });
      }
      
      setupVideo() {
        const video = document.getElementById('bgVideo');
        
        // 動画の自動再生を確実にする
        const playVideo = () => {
          video.play().catch(err => {
            console.log('自動再生に失敗しました。ユーザー操作を待ちます。');
            // ユーザー操作後に再生
            document.addEventListener('click', () => {
              video.play();
            }, { once: true });
          });
        };
        
        // 動画の準備ができたら再生
        if (video.readyState >= 3) {
          playVideo();
        } else {
          video.addEventListener('canplaythrough', playVideo, { once: true });
        }
        
        // メモリ最適化: バックグラウンドで一時停止
        document.addEventListener('visibilitychange', () => {
          if (document.hidden) {
            video.pause();
          } else {
            video.play();
          }
        });
      }
      
      hideLoading() {
        setTimeout(() => {
          const loadingOverlay = document.getElementById('loadingOverlay');
          loadingOverlay.classList.add('hidden');
          
          setTimeout(() => {
            loadingOverlay.style.display = 'none';
          }, 500);
        }, 1000);
      }
      
      handleScroll(deltaY) {
        // スクロール量を位置に変換
        const scrollAmount = deltaY * 0.001;
        this.moveCharacter(scrollAmount);
      }
      
      moveCharacter(amount) {
        // キャラクター位置を更新（0〜1の範囲）
        this.characterPosition = Math.max(0, Math.min(1, this.characterPosition + amount));
        
        // キャラクターとカードを移動
        this.updatePositions();
      }
      
      updatePositions() {
        const character = document.getElementById('character');
        const track = document.getElementById('cardsTrack');
        const screenWidth = window.innerWidth;
        
        // キャラクターの位置を計算
        let charX;
        if (this.characterPosition <= 0.1) {
          // 開始位置
          charX = 50 + (screenWidth * 0.3 - 50) * (this.characterPosition / 0.1);
        } else if (this.characterPosition >= 0.9) {
          // 終了位置
          charX = screenWidth * 0.3 + (screenWidth - 150 - screenWidth * 0.3) * ((this.characterPosition - 0.9) / 0.1);
        } else {
          // 中間はキャラクターを固定
          charX = screenWidth * 0.3;
        }
        
        character.style.left = charX + 'px';
        
        // カードのスクロール
        const cardWidth = 304; // カード幅 + gap
        const totalWidth = cardWidth * this.cards.length;
        const maxScroll = totalWidth - screenWidth + 100;
        const scrollX = -maxScroll * this.characterPosition;
        
        track.style.transform = `translateX(${scrollX}px)`;
        
        // 現在のカードをハイライト
        const currentCardIndex = Math.round(this.characterPosition * (this.cards.length - 1));
        this.highlightCard(currentCardIndex);
      }
      
      highlightCard(index) {
        const cards = document.querySelectorAll('.card');
        cards.forEach((card, i) => {
          if (i === index) {
            card.style.transform = 'translateY(-5px) scale(1.02)';
            card.style.boxShadow = '0 20px 40px rgba(0,0,0,0.4)';
          } else {
            card.style.transform = '';
            card.style.boxShadow = '';
          }
        });
      }
      
      onCardClick(index) {
        if (!this.viewedCards.has(index)) {
          this.viewedCards.add(index);
          this.gainExp(10);
        }
      }
      
      gainExp(amount) {
        this.currentExp += amount;
        
        if (this.currentExp >= this.maxExp) {
          this.levelUp();
        }
        
        this.updateUI();
      }
      
      levelUp() {
        this.currentLevel++;
        this.currentExp = 0;
        
        // レベルアップエフェクト
        const character = document.querySelector('.character-body');
        character.style.filter = 'brightness(2)';
        setTimeout(() => {
          character.style.filter = '';
        }, 500);
      }
      
      updateUI() {
        const levelEl = document.getElementById('currentLevel');
        const expFill = document.getElementById('expFill');
        
        levelEl.textContent = this.currentLevel;
        expFill.style.width = (this.currentExp / this.maxExp * 100) + '%';
      }
      
      jump() {
        const character = document.querySelector('.character');
        character.style.transition = 'transform 0.3s ease';
        character.style.transform = 'translateY(-30px)';
        
        setTimeout(() => {
          character.style.transform = '';
        }, 300);
      }
    }
    
    // ゲーム開始
    document.addEventListener('DOMContentLoaded', () => {
      new VideoBackgroundGame();
    });
  </script>
</body>
</html>